🔐 2段階認証（2FA）＆アカウントロック機能

このアプリでは、メールアドレス + パスワード に加えて
ワンタイムパスワード（TOTP）を用いた2段階認証（2FA） を導入しています。
さらに、ログイン失敗による アカウントロック機能 でセキュリティを強化しています。

✨ 初回セットアップ（ユーザー登録）

/signup 画面でユーザー登録

登録成功時に QRコード が生成され、画面に表示

Google AuthenticatorなどでQRコードを読み取ることで 2FAが有効化

保存される情報：

メールアドレスとパスワード（ハッシュ化済み）

暗号化されたTOTPシークレット

バックアップコード（使い捨て方式、必要に応じて使用可能）

🔑 ログインフロー

メールアドレス・パスワード入力

サーバで認証成功 → 2FA待機状態 の Cookie を発行

2FA入力画面（/2fa/login）でワンタイムパスワードを入力

30秒ごとに更新される6桁のコード

バックアップコードも使用可能

認証成功でログイン完了

セッションまたはJWTを発行し、完全ログイン

🔒 アカウントロック機能

ログイン失敗5回でアカウントを15分間ロック

ロック中はログイン画面の入力欄とボタンを すべて無効化

表示例：

アカウントはロックされています。15分後に再試行してください。


これにより、入力フォームを打ち直すこともできません

📌 利用イメージ

/signup にアクセス → ユーザー登録

QRコードをスマホで読み取る → 2FA有効化

/login にアクセス → メールアドレス・パスワードを入力

2FA画面でワンタイムパスワード入力 → ログイン完了

パスワード5回間違えると → アカウントロック発動

🔮 今後の拡張案

パスワードリセット機能（メールリンク経由）

2FAの再設定や無効化を可能にする画面

同時ログインデバイスの制御

バックアップコードの追加発行・履歴確認・CSVダウンロード

QRコード読み取りチュートリアルや2FA未完了アラートのUI改善